{% extends "base.html" %}

{% block title %}About Me | Prashanth Kumar Kadasi{% endblock %}

{% block content %}
<!-- Interactive Particle Canvas (Full Page) -->
<canvas id="particleCanvas"></canvas>

<div class="container" style="position: relative; z-index: 1;">
    <!-- Hero Section -->
    <div class="hero-section">
        <h1 class="hero-title">Prashanth Kumar Kadasi</h1>
        <p class="hero-subtitle">
            <span class="typing-text" id="typingText"></span><span class="typing-cursor"></span>
        </p>
        <p style="font-size: 1.1rem; max-width: 600px; margin: 0 auto 2rem; animation: fadeInUp 1s ease-out 0.5s both;">
            I build intelligent applications that solve real-world problems.
            From AI-powered health advisors to local CLI tools, I love turning ideas into reality.
        </p>

        <!-- Social Links -->
        <div style="margin-bottom: 2rem; animation: fadeInUp 1s ease-out 0.7s both;">
            <a href="https://github.com/kprsnt2" target="_blank" class="social-btn">
                <i class="fab fa-github"></i> GitHub
            </a>
            <a href="https://www.linkedin.com/in/prashanth-kumar-kadasi-b5281765/" target="_blank" class="social-btn">
                <i class="fab fa-linkedin"></i> LinkedIn
            </a>
            <a href="https://x.com/prashanth_29" target="_blank" class="social-btn">
                ùïè Twitter
            </a>
            <a href="mailto:kprsnt@gmail.com" class="social-btn">
                <i class="fas fa-envelope"></i> Email
            </a>
        </div>

        <!-- AI Insight Button -->
        <div style="animation: fadeInUp 1s ease-out 0.9s both;">
            <button class="ai-insight-btn" id="aiInsightBtn" onclick="generateAIInsight()">
                <i class="fas fa-magic"></i> AI Insight
                <span class="ai-sparkle">‚ú®</span>
            </button>
        </div>
    </div>

    <!-- About Cards -->
    <div class="row">
        <div class="col-12 col-md-6 mb-4">
            <div class="card h-100">
                <div class="card-header">üöÄ What I Do</div>
                <div class="card-body">
                    <p>I specialize in building AI-powered applications, data visualizations,
                        and web platforms. Whether it's deploying LLMs locally or creating
                        interactive dashboards, I enjoy every step of the development process.</p>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-6 mb-4">
            <div class="card h-100">
                <div class="card-header">üõ†Ô∏è Tech Stack</div>
                <div class="card-body">
                    <p>Python ‚Ä¢ JavaScript ‚Ä¢ React ‚Ä¢ Next.js ‚Ä¢ Node.js ‚Ä¢
                        Dash ‚Ä¢ Flask ‚Ä¢ Docker ‚Ä¢ GCP ‚Ä¢ Vercel ‚Ä¢ MongoDB ‚Ä¢
                        LLMs (Gemma, Ollama, OpenRouter)</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Featured Projects Preview -->
    <div class="row">
        <div class="col-12">
            <h3 style="margin-top: 2rem; margin-bottom: 1.5rem;">Featured Projects</h3>
        </div>

        <div class="col-12 col-md-4 mb-4">
            <div class="card h-100">
                <div class="card-header">‚ö° MyLocalCLI</div>
                <div class="card-body">
                    <p>A Claude Code alternative with 6 providers, 26 tools, and full privacy.</p>
                    <a href="/projects" class="btn btn-info btn-sm">Explore ‚Üí</a>
                </div>
            </div>
        </div>

        <div class="col-12 col-md-4 mb-4">
            <div class="card h-100">
                <div class="card-header">ü©∫ AI Health Pro</div>
                <div class="card-body">
                    <p>AI-powered health advisor with symptom analysis and drug recommendations.</p>
                    <a href="/projects" class="btn btn-info btn-sm">Explore ‚Üí</a>
                </div>
            </div>
        </div>

        <div class="col-12 col-md-4 mb-4">
            <div class="card h-100">
                <div class="card-header">üíä PharmGenesisAI</div>
                <div class="card-body">
                    <p>AI-powered drug discovery tool for Pharma R&D research.</p>
                    <a href="/projects" class="btn btn-info btn-sm">Explore ‚Üí</a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Interactive Particle Trail Script -->
<script>
    const canvas = document.getElementById('particleCanvas');
    const ctx = canvas.getContext('2d');
    let particles = [];

    // Set canvas size
    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = document.body.scrollHeight;
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    // Particle class - spawns from mouse with glow and gravity
    class Particle {
        constructor(x, y) {
            this.x = x;
            this.y = y;
            this.size = Math.random() * 8 + 3;
            this.speedX = (Math.random() - 0.5) * 4;
            this.speedY = (Math.random() - 0.5) * 4 - 1; // Slight upward bias
            this.gravity = 0.05;
            this.hue = Math.random() * 60 + 230; // Blue-purple range
            this.opacity = 1;
            this.decay = Math.random() * 0.015 + 0.008;
        }

        draw() {
            // Glow effect
            ctx.shadowBlur = 15;
            ctx.shadowColor = `hsla(${this.hue}, 70%, 60%, ${this.opacity})`;

            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            ctx.fillStyle = `hsla(${this.hue}, 70%, 60%, ${this.opacity})`;
            ctx.fill();

            ctx.shadowBlur = 0;
        }

        update() {
            this.speedY += this.gravity; // Add gravity
            this.x += this.speedX;
            this.y += this.speedY;
            this.opacity -= this.decay;
            this.size *= 0.97;
            if (this.size > 0.5) this.draw();
        }
    }

    // Spawn particles on mouse move
    let lastX = 0, lastY = 0;
    window.addEventListener('mousemove', (e) => {
        const x = e.x;
        const y = e.y + window.scrollY;

        // Calculate speed for trail intensity
        const dx = x - lastX;
        const dy = y - lastY;
        const speed = Math.sqrt(dx * dx + dy * dy);
        const particleCount = Math.min(Math.floor(speed / 3) + 2, 8);

        // Spawn particles based on movement speed
        for (let i = 0; i < particleCount; i++) {
            particles.push(new Particle(x, y));
        }

        lastX = x;
        lastY = y;
    });

    // Draw connecting lines between nearby particles
    function connectParticles() {
        for (let a = 0; a < particles.length; a++) {
            for (let b = a + 1; b < particles.length; b++) {
                let dx = particles[a].x - particles[b].x;
                let dy = particles[a].y - particles[b].y;
                let distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < 80) {
                    let opacity = Math.min(particles[a].opacity, particles[b].opacity);
                    ctx.strokeStyle = `rgba(102, 126, 234, ${opacity * 0.3})`;
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.moveTo(particles[a].x, particles[a].y);
                    ctx.lineTo(particles[b].x, particles[b].y);
                    ctx.stroke();
                }
            }
        }
    }

    // Animation loop
    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Update and filter dead particles
        particles = particles.filter(p => p.opacity > 0);

        for (let particle of particles) {
            particle.update();
        }

        connectParticles();

        requestAnimationFrame(animate);
    }
    animate();

    // ===== Typing Animation =====
    const roles = [
        'Data Analyst',
        'AI Developer',
        'Data Engineer',
        'LLM Enthusiast',
        'Full-Stack Builder'
    ];
    let roleIndex = 0;
    let charIndex = 0;
    let isDeleting = false;
    const typingElement = document.getElementById('typingText');

    function type() {
        const currentRole = roles[roleIndex];

        if (isDeleting) {
            typingElement.textContent = currentRole.substring(0, charIndex - 1);
            charIndex--;
        } else {
            typingElement.textContent = currentRole.substring(0, charIndex + 1);
            charIndex++;
        }

        let typeSpeed = isDeleting ? 50 : 100;

        if (!isDeleting && charIndex === currentRole.length) {
            typeSpeed = 2000;
            isDeleting = true;
        } else if (isDeleting && charIndex === 0) {
            isDeleting = false;
            roleIndex = (roleIndex + 1) % roles.length;
            typeSpeed = 500;
        }

        setTimeout(type, typeSpeed);
    }

    setTimeout(type, 1000);

    // ===== AI Insight Modal Functions =====
    async function generateAIInsight() {
        const btn = document.getElementById('aiInsightBtn');
        const modal = document.getElementById('aiInsightModal');
        const content = document.getElementById('aiInsightContent');

        // Show loading state
        btn.disabled = true;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';

        try {
            const response = await fetch('/api/ai-insight', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            });

            const data = await response.json();

            if (data.success) {
                // Convert markdown to HTML (basic conversion)
                let html = data.insight
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\*(.*?)\*/g, '<em>$1</em>')
                    .replace(/`(.*?)`/g, '<code>$1</code>')
                    .replace(/\n\n/g, '</p><p>')
                    .replace(/\n/g, '<br>');
                content.innerHTML = '<p>' + html + '</p>';
            } else {
                content.innerHTML = '<p class="error-text">‚ùå ' + (data.error || 'Failed to generate insight') + '</p>';
            }

            modal.classList.add('show');
        } catch (error) {
            content.innerHTML = '<p class="error-text">‚ùå Connection error. Please try again.</p>';
            modal.classList.add('show');
        } finally {
            btn.disabled = false;
            btn.innerHTML = '<i class="fas fa-magic"></i> AI Insight <span class="ai-sparkle">‚ú®</span>';
        }
    }

    function closeInsightModal() {
        document.getElementById('aiInsightModal').classList.remove('show');
    }

    // Close modal on outside click
    document.getElementById('aiInsightModal')?.addEventListener('click', function (e) {
        if (e.target === this) closeInsightModal();
    });

    // Close on ESC key
    document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape') closeInsightModal();
    });
</script>

<!-- AI Insight Modal -->
<div class="ai-insight-modal" id="aiInsightModal">
    <div class="ai-insight-popup">
        <button class="modal-close" onclick="closeInsightModal()">
            <i class="fas fa-times"></i>
        </button>
        <div class="modal-header">
            <i class="fas fa-robot"></i>
            <h3>AI Portfolio Insight</h3>
        </div>
        <div class="modal-body" id="aiInsightContent">
            <p>Loading insights...</p>
        </div>
    </div>
</div>
{% endblock %}